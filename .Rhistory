gen_overview <- function(path_input = "D:/km/Truhart") {
# Creating a list of all the available excel files. Important! The rows of the
# overview function "excel_files" need to be ordered
excel_files <-
list.files(
path = path_input,
pattern = "xlsx",
recursive = TRUE,
full.names = TRUE
) %>%
tibble::as_tibble() %>%
dplyr::mutate(
Startpage =
as.integer(
stringi::stri_extract_last_regex(
value,
"[0-9]+(?=to|-)"
)
),
Endpage =
as.integer(
stringi::stri_extract_last_regex(
value,
"(?<=to|-)[0-9]+"
)
),
Continent =
stringi::stri_extract_last_regex(
value,
"(?<=\\/km\\/Truhart\\/)[A-z]+"
)
) %>%
dplyr::arrange(Continent, Startpage)
return(excel_files)
}
excel_files <-
list.files(
path = path_input,
pattern = "xlsx",
recursive = TRUE,
full.names = TRUE
) %>%
tibble::as_tibble() %>%
dplyr::mutate(
Startpage =
as.integer(
stringi::stri_extract_last_regex(
value,
"[0-9]+(?=to|-)"
)
),
Endpage =
as.integer(
stringi::stri_extract_last_regex(
value,
"(?<=to|-)[0-9]+"
)
),
Continent =
stringi::stri_extract_last_regex(
value,
"(?<=\\/km\\/Truhart\\/)[A-z]+"
)
) %>%
dplyr::arrange(Continent, Startpage)
path_input = "D:/km/Truhart"
excel_files <-
list.files(
path = path_input,
pattern = "xlsx",
recursive = TRUE,
full.names = TRUE
) %>%
tibble::as_tibble() %>%
dplyr::mutate(
Startpage =
as.integer(
stringi::stri_extract_last_regex(
value,
"[0-9]+(?=to|-)"
)
),
Endpage =
as.integer(
stringi::stri_extract_last_regex(
value,
"(?<=to|-)[0-9]+"
)
),
Continent =
stringi::stri_extract_last_regex(
value,
"(?<=\\/km\\/Truhart\\/)[A-z]+"
)
) %>%
dplyr::arrange(Continent, Startpage)
excel_files <-
list.files(
path = path_input,
pattern = "xlsx",
recursive = TRUE,
full.names = TRUE
) %>%
tibble::as_tibble() %>%
dplyr::mutate(
Startpage =
as.integer(
stringi::stri_extract_last_regex(
value,
"[0-9]+(?=to|-)"
)
),
Endpage =
as.integer(
stringi::stri_extract_last_regex(
value,
"(?<=to|-)[0-9]+"
)
),
Continent =
stringi::stri_extract_last_regex(
value,
"(?<=\\/km\\/Truhart\\/)[A-z]+"
)
) %>%
dplyr::arrange(Continent, Startpage)
